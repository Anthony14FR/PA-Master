#!/bin/sh

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")
BRANCH_NAME=$(git rev-parse --abbrev-ref HEAD)

# Vérifier cohérence branche/commit
if echo "$BRANCH_NAME" | grep -qE "^feature/" && ! echo "$COMMIT_MSG" | grep -qE "^feat:"; then
    echo "❌ Branche 'feature/' doit avoir un commit 'feat:'"
    echo "Branche: $BRANCH_NAME | Commit: $COMMIT_MSG"
    echo "😎 Signé: le petit blond relou 😘"
    exit 1
elif echo "$BRANCH_NAME" | grep -qE "^fix/" && ! echo "$COMMIT_MSG" | grep -qE "^fix:"; then
    echo "❌ Branche 'fix/' doit avoir un commit 'fix:'"
    echo "Branche: $BRANCH_NAME | Commit: $COMMIT_MSG"
    echo "😎 Signé: le petit blond relou 😘"
    exit 1
fi

echo "✅ Message de commit valide bravo tié le goat"
exit 0